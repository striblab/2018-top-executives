
<div class="strib-styles ssa ssb ssc">
  <section class="container-lg">
    <header class="hero">
      <h1>
        Star Tribune<br>
        <span class="sub-title">The 27<sup>th</sup> Top Executives</span>
      </h1>

      <p class="lead container-md">A strong economy helped the 50 largest public companies in Minnesota to increase overall revenues 6.6 percent, better than 2016 when collective revenues grew 4.4 percent.</p>

      <div class="byline">
        <address>By
          <a rel="author" href="http://www.startribune.com/patrick-kennedy/10645186/">Patrick Kennedy</a>
        </address>
        <span class="spacer"></span>
        Star Tribune
        <span class="spacer-alt"></span>
        <time pubdate datetime="2018-06-17T16:00:00">June 17, 2018</time>
      </div>

      <div class="sharing-placeholder">
        <!-- share -->
      </div>
    </header>

    <main>
      <div class="controls">
        <h1 aria-label="controls-form" class="sr-only">Controls to adjust list of executives</h1>

        <form class="inline-form" id="controls-form">
          <div class="inline-form-element">
            <label for="filter-category">Filter:</label>
            <div id="filter-category" role="group">
              <button type="button" data-value="" class="active">All</button>

              {#each categories as category, ci}
                <button class="category-color-{ ci + 1 }" type="button" data-value="{ kebabCase(category) }">{ category }</button>
              {/each}
            </div>
          </div>
        </form>
      </div>

      <h1 aria-label="executives-list" class="sr-only">List of companies</h1>
      <div class="executives-list">
        {#each ceoTop as c}
          <div class="executive category-color-{ c.company.category ? categories.indexOf(c.company.category) + 1 : 'none' }"
            data-officer-id="{ c.coid }"
            data-company-id="{ c.company.coid }"
            data-category="{ kebabCase(c.company.category) }">
            <div class="row">
              <div class="col col-20 col-md-30">
                <div class="row">
                  <div class="col col-100 col-md-50">
                    <div class="rank">
                      { c.salaries[publishYear].rank }
                    </div>
                  </div>

                  <div class="col col-100 col-md-50">
                    {#if c.hasimage }
                      <img src="./assets/images/executives/{ c.id }.jpg" alt="Headshot of { officerName(c) }" />
                    {:else}
                      <img src="./assets/images/generic-headshot.jpg" alt="Generic headshot image" />
                    {/if}
                  </div>
                </div>
              </div>

              <div class="col col-80 col-md-70">
                <h2>{ officerName(c) }</h2>

                <div class="officer-title">{ c.salaries[publishYear].title } of { c.company.name }</div>

                <p>{ c.company.shortdesc }</p>
              </div>
            </div>

            <div class="row data-row">
              <div class="col col-0 col-md-15">&nbsp;</div>

              <div class="col col-100 col-md-35">
                <ul>
                  <li class="main-financial">
                    <span class="main-financial-value">
                      ${ millions(c.salaries[publishYear].calculated_total_value).toLocaleString() }
                    </span> million in total compensation
                  </li>

                  <li class="main-financial">
                    <span class="main-financial-value">
                      { percentChange(c.salaries, publishYear, 'calculated_total_value') ?
                        percentChange(c.salaries, publishYear, 'calculated_total_value').toLocaleString() + '%' :
                        'n/a' }
                    </span> change from { publishYear - 1}
                  </li>

                  <li>
                    CEO pay ratio
                    {#if c.salaries[publishYear].ceopayratio }
                      <strong>{ c.salaries[publishYear].ceopayratio.toLocaleString() }:1</strong>
                    {:else}
                      <strong><span title="Unknown pay ratio">&mdash</span></strong>
                    {/if}
                  </li>

                  <li>Median compensation
                    {#if c.salaries[publishYear].medianemployeepay }
                      <strong>${ c.salaries[publishYear].medianemployeepay.toLocaleString() }</strong>
                    {:else}
                      <strong><span title="Unknown median employee pay">&mdash</span></strong>
                    {/if}
                  </li>
                </ul>
              </div>

              <div class="col col-100 col-md-25">
                <ul>
                  <li>
                    Salary
                    <strong>${ millions(c.salaries[publishYear].salary || 0).toLocaleString() } million</strong>
                  </li>

                  <li>
                    Bonus
                    <strong>${ (c.salaries[publishYear].bonus || 0).toLocaleString() }</strong>
                  </li>

                  <li>
                    Non-equity IPC
                    <strong>${ (c.salaries[publishYear].nonequityipc || 0).toLocaleString() }</strong>
                  </li>

                  <li>
                    All other
                    <strong>${ (c.salaries[publishYear].allothertotal || 0).toLocaleString() }</strong>
                  </li>
                </ul>
              </div>

              <div class="col col-100 col-md-25">
                <ul>
                  <li>
                    Stock options
                    <strong>${ (c.salaries[publishYear].stockoptions || 0).toLocaleString() }</strong>
                  </li>

                  <li>
                    Shares vesting
                    <strong>${ (c.salaries[publishYear].sharesvesting || 0).toLocaleString() }</strong>
                  </li>

                  <li>
                    Stock change
                    <strong>{ (c.salaries[publishYear].stockchange || 0).toLocaleString() }%</strong>
                  </li>

                  <li>
                    { publishYear - 1 } Top-50 ranking:
                    <strong>{ c.salaries[publishYear - 1] ? c.salaries[publishYear - 1].rank : 'n/a' }</strong>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        {/each}
      </div>
    </main>

    <footer class="container-md">
      <div class="credits">
        <p>The Star Tribune 50 is a measure of the largest publicly held companies with headquarters in Minnesota ranked by revenue. Another 23 companies were considered but whose revenues were too small for the list. Data for the 50 largest companies also includes each company&rsquo;s net income before extraordinary item &mdash; many companies adjusted net income based on corporate tax reform, assets and market capitalization. Data for the list was taken from Thomson Reuters.</p>

        <p>The list excludes public companies that do not trade on major exchanges, closely held companies, which usually do not disclose financial data, cooperatives and fraternal benefits organizations. Companies that closed acquisitions in 2018 but did not file year-end results were also excluded. Companies who have management headquarters in Minnesota, including Medtronic, Pentair and Winnebago Industries are included.</p>

        <p>Star Tribune graphic: Patrick Kennedy, Alan Palazzolo, Jamie Hutt, David Braunger, Billy Steve Clayton</p>
      </div>
    </footer>
  </section>
</div>

<script>
  import _ from "lodash";

  export default {
    computed: {
      // Top 50
      ceoTop: ({ executives, publishYear }) => {
        return _.take(
          _.sortBy(executives.ceo, o => o.salaries[publishYear].rank),
          50
        );
      },

      // All categories
      categories: ({ executives }) => {
        return _.filter(_.uniq(_.map(executives.ceo, c => c.company.category)));
      }
    },

    helpers: {
      kebabCase: _.kebabCase,

      // Officer name
      officerName(o) {
        return `${
          o.salut && !o.salut.match(/(mr|ms|mrs)/i) ? o.salut + " " : ""
        }${_.filter([o.first, o.middle, o.last]).join(" ")}${
          o.lineage ? ", " + o.lineage : ""
        }`;
      },

      // Format in millions
      millions(i) {
        if (!i) {
          return 0;
        }

        return Math.round(i / 100000 * 10) / 10;
      },

      // Find percent change
      percentChange(set, year, value) {
        let c = set[year] ? set[year][value] : 0;
        let p = set[year - 1] ? set[year - 1][value] : undefined;

        if (!p) {
          return undefined;
        }

        return Math.round((c - p) / p * 100 * 10) / 10;
      }
    },

    // Default data
    data: () => {
      return {
        publishYear: 2018
      };
    }
  };
</script>
